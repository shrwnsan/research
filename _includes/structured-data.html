{%- comment -%}
Comprehensive JSON-LD structured data for Jekyll sites
Supports multiple page types: BlogPosting, WebSite, WebPage, BreadcrumbList, Organization
{%- endcomment -%}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {%- comment -%} Website Schema {%- endcomment -%}
    {
      "@type": "WebSite",
      "@id": {{ site.url | append: site.baseurl | append: "/#website" | jsonify }},
      "url": {{ site.url | append: site.baseurl | jsonify }},
      "name": {{ site.title | jsonify }},
      "description": {{ site.description | jsonify }},
      "inLanguage": "en-US",
      "isFamilyFriendly": "true",
      "potentialAction": {
        "@type": "SearchAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": {{ site.url | append: site.baseurl | append: "/search?q={search_term_string}" | jsonify }}
        },
        "query-input": "required name=search_term_string"
      },
      "publisher": {
        "@id": {{ site.url | append: site.baseurl | append: "/#organization" | jsonify }}
      }
    },

    {%- comment -%} Organization Schema {%- endcomment -%}
    {
      "@type": "Organization",
      "@id": {{ site.url | append: site.baseurl | append: "/#organization" | jsonify }},
      "name": {{ site.title | jsonify }},
      "url": {{ site.url | append: site.baseurl | jsonify }},
      "logo": {
        "@type": "ImageObject",
        "url": {{ site.url | append: site.baseurl | append: "/apple-touch-icon-precomposed.png" | jsonify }},
        "width": 144,
        "height": 144
      },
      "description": {{ site.description | jsonify }},
      "sameAs": [],
      "contactPoint": {
        "@type": "ContactPoint",
        "contactType": "research",
        "availableLanguage": "English"
      }
    }

    {%- comment -%} Blog Page Specific Schema {%- endcomment -%}
    {%- if page.layout == "post" -%}
    ,
    {
      "@type": "BlogPosting",
      "@id": {{ page.url | absolute_url | append: "#blogposting" | jsonify }},
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": {{ page.url | absolute_url | jsonify }}
      },
      "headline": {{ page.title | jsonify }},
      {%- if page.excerpt -%}
      "description": {{ page.excerpt | strip_html | strip_newlines | jsonify }},
      {%- endif -%}
      "image": [
        {{ site.url | append: site.baseurl | append: "/apple-touch-icon-precomposed.png" | jsonify }}
      ],
      "datePublished": {{ page.date | date_to_xmlschema | jsonify }},
      "dateModified": {{ page.date | date_to_xmlschema | jsonify }},
      "author": {
        "@type": "Person",
        "name": {{ site.author.name | jsonify }},
        "url": {{ site.author.url | jsonify }}
      },
      "publisher": {
        "@type": "Organization",
        "@id": {{ site.url | append: site.baseurl | append: "/#organization" | jsonify }},
        "name": {{ site.title | jsonify }},
        "logo": {
          "@type": "ImageObject",
          "url": {{ site.url | append: site.baseurl | append: "/apple-touch-icon-precomposed.png" | jsonify }},
          "width": 144,
          "height": 144
        }
      },
      "wordCount": {{ content | strip_html | strip_newlines | split: " " | size }},
      "keywords": "research, AI, agentic systems, {{ page.title | downcase | replace: " ", ", " }}",
      "articleSection": "Research",
      "inLanguage": "en-US",
      "isPartOf": {
        "@type": "Blog",
        "@id": {{ site.url | append: site.baseurl | append: "/#blog" | jsonify }},
        "name": {{ site.title | jsonify }},
        "publisher": {
          "@id": {{ site.url | append: site.baseurl | append: "/#organization" | jsonify }}
        }
      }
    }

    {%- comment -%} BreadcrumbList for Blog Posts {%- endcomment -%}
    ,
    {
      "@type": "BreadcrumbList",
      "@id": {{ page.url | absolute_url | append: "#breadcrumb" | jsonify }},
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": {{ site.url | append: site.baseurl | jsonify }}
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Blog",
          "item": {{ site.url | append: site.baseurl | append: "/" | jsonify }}
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": {{ page.title | jsonify }},
          "item": {{ page.url | absolute_url | jsonify }}
        }
      ]
    }

    {%- comment -%} Homepage Schema {%- endcomment -%}
    {%- elsif page.title == "Home" -%}
    ,
    {
      "@type": "WebPage",
      "@id": {{ page.url | absolute_url | append: "#homepage" | jsonify }},
      "url": {{ page.url | absolute_url | jsonify }},
      "name": {{ site.title | jsonify }},
      "description": {{ site.description | jsonify }},
      "isPartOf": {
        "@type": "WebSite",
        "@id": {{ site.url | append: site.baseurl | append: "/#website" | jsonify }}
      },
      "about": {
        "@type": "Thing",
        "name": "AI Research",
        "description": "Technical research focused on agentic systems and AI augmentation"
      },
      "mainEntity": {
        "@type": "ItemList",
        "numberOfItems": {{ site.posts | size }},
        "itemListElement": [
          {%- for post in site.posts limit:10 -%}
          {
            "@type": "Article",
            "position": {{ forloop.index }},
            "name": {{ post.title | jsonify }},
            "url": {{ post.url | absolute_url | jsonify }},
            "datePublished": {{ post.date | date_to_xmlschema | jsonify }},
            "description": {{ post.excerpt | strip_html | strip_newlines | jsonify }}
          }{%- unless forloop.last %},{%- endunless -%}
          {%- endfor -%}
        ]
      }
    }

    {%- comment -%} Regular WebPage Schema {%- endcomment -%}
    {%- else -%}
    ,
    {
      "@type": "WebPage",
      "@id": {{ page.url | absolute_url | append: "#webpage" | jsonify }},
      "url": {{ page.url | absolute_url | jsonify }},
      "name": {{ page.title | jsonify }},
      {%- if page.excerpt -%}
      "description": {{ page.excerpt | strip_html | strip_newlines | jsonify }},
      {%- elsif site.description -%}
      "description": {{ site.description | jsonify }},
      {%- endif -%}
      "isPartOf": {
        "@type": "WebSite",
        "@id": {{ site.url | append: site.baseurl | append: "/#website" | jsonify }}
      },
      "inLanguage": "en-US",
      "dateModified": {{ site.time | date_to_xmlschema | jsonify }}
    }

    {%- comment -%} BreadcrumbList for Static Pages {%- endcomment -%}
    ,
    {
      "@type": "BreadcrumbList",
      "@id": {{ page.url | absolute_url | append: "#breadcrumb" | jsonify }},
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": {{ site.url | append: site.baseurl | jsonify }}
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": {{ page.title | jsonify }},
          "item": {{ page.url | absolute_url | jsonify }}
        }
      ]
    }
    {%- endif -%}

    {%- comment -%} Website Feed Schema {%- endcomment -%}
    {%- if page.title == "Home" or page.layout == "post" -%}
    ,
    {
      "@type": "DataFeed",
      "@id": {{ site.url | append: site.baseurl | append: "/#feed" | jsonify }},
      "name": {{ site.title | append: " - RSS Feed" | jsonify }},
      "description": {{ "Latest research articles and analysis from " | append: site.title | jsonify }},
      "dataFeedElement": [
        {
          "@type": "DataFeedItem",
          "dateModified": {{ site.time | date_to_xmlschema | jsonify }},
          "item": {
            "@type": "WebPage",
            "@id": {{ site.url | append: site.baseurl | append: "/#website" | jsonify }}
          }
        }
      ],
      "provider": {
        "@type": "Organization",
        "@id": {{ site.url | append: site.baseurl | append: "/#organization" | jsonify }}
      }
    }
    {%- endif -%}
  ]
}
</script>